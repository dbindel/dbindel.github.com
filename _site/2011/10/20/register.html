<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">  
    <title>Voodoo and the register keyword - Eigenmumbles</title>
    
    <meta name="author" content="David Bindel">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" media="screen" href="http://dbindel.github.com/stylesheets/styles.css" type="text/css" />
    <link href="http://dbindel.github.com/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed" />
    
    

    <!-- mathjax config similar to math.stackexchange -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [['$', '$']],
          displayMath: [['$$', '$$']],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        },
      messageStyle: "none",
      "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
    });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script> 

  </head>
  <body>

    <div class="topbar">
      <div class="fill">
        <nav class="container">
          <a class="brand" href="#">Eigenmumbles</a>
          <ul class="nav">
            <li><a href="http://dbindel.github.com/">Home</a></li>
            <li><a href="http://dbindel.github.com/about.html">About</a></li>
            <li><a href="http://dbindel.github.com/archive.html">Archive</a></li>
          </ul>
          <form method="get" action="http://www.google.com/search" class="pull-right">
            <input class="input-small" type="text" name="q" size="31" maxlength="255" value="">
            <input name="sitesearch" type="hidden" value="dbindel.github.com">
            <button class="btn" type="submit">Search</button>
          </form>
        </nav>
      </div>
    </div>

    <div class="container">

      <div class="content">
        <header class="page-header">
          <h1>Eigenmumbles</h1>
        </header>
        <div class="row">
          <div id="content" class="span12">
            <article>
  <header>
    <h2>
      <a href="http://dbindel.github.com//2011/10/20/register.html" rel="bookmark" title="Permanent link to ">Voodoo and the register keyword</a>
    </h2>
    <h5><time>October 20, 2011</time></h5>
  </header>

  <p>When the C programming language was born, the language was very close to the
machine.  But both compiler technology and computer architecture have moved on
since the invention of C in the early 1970s, and modern optimizing compilers
sometimes translate in mysterious ways.  Writing high-performance code now can
be as much about exposing opportunities for optimization and letting the
compiler do its job as it is about micromanaging the details of what the
compiler should do.  Human beings are better than compilers at seeing
high-level aspects of an algorithm that might lead to better or worse
performance; and compilers are typically much better at low-level tasks like
scheduling instructions and allocating registers.</p>

<p>Though compilers are now typically better than humans at register allocation,
the C programming language retains the <code>register</code> keyword, which is supposed to
be a hint to the compiler that it is appropriate to put a certain variable in a
register.  Compilers are not required to take this hint; the only mandatory
effect of declaring a variable to be a <code>register</code> variable is that you are no
longer allowed to take its address.  And yet, one of the most popular attempted
optimizations for the matrix multiplication assignment in my high-performance
computing class is to add <code>register</code> annotations to a bunch of the variables,
even though I tell the students that it will probably have no real impact.
Why is this so?</p>

<p>I think the allure of <code>register</code>, along with the allure of more grotty C tricks
like <a href="http://www.lysator.liu.se/c/duffs-device.html">Duff&rsquo;s device</a>, is that it
seems almost like a magical incantation.  Wouldn&rsquo;t it be nice if there was a
formula that some wizardly programmer could chant over code in order to make it
go fast?  Of course, if there really is a formula, compiler writers now will
incorporate it into the optimizer.  This may not be good for the mystique of
code tuning, but it certainly makes good engineering sense.  After all, the
magic of the computer is that it can automate things for which you can find
a formula!</p>

<p>What is interesting about these tricks is not that they represent a sort of
lore on how to optimize things now, but rather they are historical artifacts
that show something about the joint evolution of machine architectures,
compilers, and programming wisdom.  They aren&rsquo;t magical in any real
sense, but they surely are worth enjoying as evidence that programmers in
the past were just as clever as we fancy ourselves to be today.</p>
 
   
  <nav id="related">
    <h3>Related Posts</h3>
    <ul class="posts">
      
        <li><span>22 Jul 2012</span> - <a href="http://dbindel.github.com//2012/07/22/disqus.html">disqus</a></li>
      
        <li><span>22 Jul 2012</span> - <a href="http://dbindel.github.com//2012/07/22/github.html">Github</a></li>
      
        <li><span>10 Feb 2012</span> - <a href="http://dbindel.github.com//2012/02/10/sensitivity.html">Automated sensitivity analysis</a></li>
      
        <li><span>24 Jan 2012</span> - <a href="http://dbindel.github.com//2012/01/24/vnote.html">Screencasts, take 2</a></li>
      
        <li><span>20 Jan 2012</span> - <a href="http://dbindel.github.com//2012/01/20/experiment.html">experiment</a></li>
      
    </ul>
  </nav>

  
  <div id="comments">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_identifier = "/2011/10/20/register.html";
      (function() {
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = 'http://eigenmumbles.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=eigenmumbles">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</article>


          </div>
          <nav class="span4">
            <h3>Recent Posts</h3>
            <div id="posts">
              
                <p><a href="http://dbindel.github.com//2012/07/24/ldoc.html">ldoc</a></p>
              
                <p><a href="http://dbindel.github.com//2012/07/22/github.html">Github</a></p>
              
                <p><a href="http://dbindel.github.com//2012/07/22/disqus.html">disqus</a></p>
              
                <p><a href="http://dbindel.github.com//2012/07/09/birds.html">The birds of Detroit</a></p>
              
                <p><a href="http://dbindel.github.com//2012/06/19/hiring.html">Hiring</a></p>
              
                <p><a href="http://dbindel.github.com//2012/06/07/coffee.html">Coffee</a></p>
              
                <p><a href="http://dbindel.github.com//2012/05/24/.html">Summer</a></p>
              
                <p><a href="http://dbindel.github.com//2012/05/13/tree.html">Tree</a></p>
              
                <p><a href="http://dbindel.github.com//2012/05/06/error.html">Error analysis</a></p>
              
                <p><a href="http://dbindel.github.com//2012/04/28/fiver.html">Five minute masterpiece</a></p>
              
            </div>
          </nav>
        </div>
      </div>

      <footer>
        <p>powered by <a href="https://github.com/mojombo/jekyll">jekyll</a></p>
      </footer>

    </div> 


  
  </body>
</html>
